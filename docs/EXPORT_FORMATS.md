# Export Formats Guide

## Overview

The GRC Compliance Tool supports multiple export formats to meet different use cases and stakeholder needs.

## Supported Formats

### 1. PDF Format

**Best For**: Executive presentations, compliance documentation, formal reports

**Features**:
- Professional formatting with company standards
- Multi-page structured reports
- Tables and charts
- Color-coded risk levels
- Page headers and footers
- Print-friendly layout

**Sections Included**:
1. Title Page
2. Executive Summary
3. Risk Assessment Details
4. Vulnerability Details
5. Mitigation Plan
6. Compliance Status

**Usage**:

```python
from grc_tool.reporting import PDFExporter, ReportGenerator

# Generate report data
report_gen = ReportGenerator('./reports')
report_data = report_gen.generate_comprehensive_report(scan_results)

# Export to PDF
pdf_exporter = PDFExporter('./reports')
pdf_path = pdf_exporter.export_to_pdf(report_data)
print(f"PDF saved to: {pdf_path}")
```

**Customization**:
- Custom filename
- Output directory
- Page size (letter/A4)
- Color schemes

### 2. JSON Format

**Best For**: Data integration, automated processing, archival

**Features**:
- Complete raw data
- Machine-readable format
- Easy parsing and processing
- No data loss
- Structured hierarchical data

**Data Structure**:
```json
{
  "scan_results": { ... },
  "vulnerabilities": [ ... ],
  "risk_assessment": { ... },
  "threats": [ ... ],
  "anomalies": [ ... ],
  "mitigation_plan": { ... },
  "remediation_plan": { ... }
}
```

**Usage**:

```python
import json

# Export to JSON
with open('report.json', 'w') as f:
    json.dump(scan_results, f, indent=2)

# Load from JSON
with open('report.json', 'r') as f:
    data = json.load(f)
```

**Integration Examples**:

```python
# Send to SIEM system
import requests
response = requests.post('https://siem.company.com/api/ingest', 
                        json=scan_results)

# Store in database
from sqlalchemy import create_engine
engine = create_engine('postgresql://user:pass@localhost/grc')
# Store data...

# Process with pandas
import pandas as pd
risks_df = pd.DataFrame(scan_results['risk_assessment']['evaluated_risks'])
```

### 3. HTML Format

**Best For**: Web sharing, documentation portals, email distribution

**Features**:
- Browser-compatible
- Responsive design
- Interactive tables
- CSS styling
- Shareable links
- No special software required

**Structure**:
- Header with report metadata
- Executive summary section
- Risk distribution table
- Top risks table
- Formatted with CSS

**Usage**:

```python
# HTML is generated by the GUI or can be created manually
from grc_tool.gui.main_window import GRCToolGUI

# In the GUI, results can be exported as HTML
# Or programmatically:
html_content = generate_html_report(scan_results)
with open('report.html', 'w') as f:
    f.write(html_content)
```

**Customization**:
```html
<!-- Custom CSS can be added -->
<style>
  body { font-family: 'Custom Font'; }
  .critical { color: #d32f2f; }
  .high { color: #f57c00; }
</style>
```

## Format Comparison

| Feature | PDF | JSON | HTML |
|---------|-----|------|------|
| Human Readable | ✓✓✓ | ✓ | ✓✓✓ |
| Machine Readable | ✗ | ✓✓✓ | ✓✓ |
| Professional Layout | ✓✓✓ | ✗ | ✓✓ |
| File Size | Medium | Small | Small |
| Integration | ✗ | ✓✓✓ | ✓✓ |
| Print Quality | ✓✓✓ | ✗ | ✓✓ |
| Email Friendly | ✓✓ | ✗ | ✓✓✓ |
| Compliance Docs | ✓✓✓ | ✓ | ✓✓ |
| Executive Review | ✓✓✓ | ✗ | ✓✓ |
| Technical Analysis | ✓✓ | ✓✓✓ | ✓✓ |

## Use Case Recommendations

### Executive Stakeholders
**Format**: PDF
- Professional appearance
- Easy to review and share
- Print for meetings
- Archive for compliance

### Security Operations Team
**Format**: JSON
- Import into SIEM
- Automate response workflows
- Integrate with ticketing systems
- Historical analysis

### IT Management
**Format**: HTML
- Share via email or intranet
- Accessible from any browser
- Easy to distribute
- Interactive review

### Compliance Officers
**Format**: PDF + JSON
- PDF for audit documentation
- JSON for compliance tracking systems
- Long-term archival

### Development Teams
**Format**: JSON
- Parse for CI/CD integration
- Track vulnerability trends
- Automate remediation tasks
- Generate custom reports

## Export Best Practices

### File Naming

```python
# Use timestamps for uniqueness
from datetime import datetime
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"grc_report_{target}_{timestamp}.pdf"
```

### Organization Structure

```
reports/
├── 2024/
│   ├── 01_January/
│   │   ├── pdf/
│   │   ├── json/
│   │   └── html/
│   └── 02_February/
├── archived/
└── compliance/
```

### Retention Policy

1. **Active Reports**: 90 days in main directory
2. **Archived Reports**: 1 year in archive
3. **Compliance Reports**: 7 years minimum
4. **JSON Raw Data**: Keep for trend analysis

### Security

```python
# Encrypt sensitive reports
from cryptography.fernet import Fernet

key = Fernet.generate_key()
cipher = Fernet(key)

# Encrypt PDF
with open('report.pdf', 'rb') as f:
    encrypted = cipher.encrypt(f.read())

with open('report.pdf.encrypted', 'wb') as f:
    f.write(encrypted)
```

### Automation

```python
# Scheduled export script
def export_all_formats(scan_results, output_dir):
    """Export scan results in all formats."""
    from grc_tool.reporting import PDFExporter, ReportGenerator
    import json
    
    # Generate report
    report_gen = ReportGenerator(output_dir)
    report_data = report_gen.generate_comprehensive_report(scan_results)
    
    # Export PDF
    pdf_exporter = PDFExporter(output_dir)
    pdf_path = pdf_exporter.export_to_pdf(report_data)
    
    # Export JSON
    json_path = os.path.join(output_dir, 'report.json')
    with open(json_path, 'w') as f:
        json.dump(scan_results, f, indent=2)
    
    # Export HTML
    html_path = os.path.join(output_dir, 'report.html')
    html_content = generate_html_report(scan_results)
    with open(html_path, 'w') as f:
        f.write(html_content)
    
    return {
        'pdf': pdf_path,
        'json': json_path,
        'html': html_path
    }
```

## API Reference

### PDFExporter Class

```python
class PDFExporter:
    def __init__(self, output_dir: str = "./reports"):
        """Initialize PDF exporter with output directory."""
        
    def export_to_pdf(self, report_data: Dict, filename: str = None) -> str:
        """
        Export report to PDF format.
        
        Args:
            report_data: Complete report data dictionary
            filename: Optional custom filename
            
        Returns:
            Path to generated PDF file
        """
```

### Methods

#### `_create_title_page(report_data: Dict) -> List`
Generate title page elements.

#### `_create_executive_summary(report_data: Dict) -> List`
Generate executive summary section.

#### `_create_risk_section(report_data: Dict) -> List`
Generate risk assessment section.

#### `_create_vulnerability_section(report_data: Dict) -> List`
Generate vulnerability details section.

#### `_create_mitigation_section(report_data: Dict) -> List`
Generate mitigation plan section.

#### `_create_compliance_section(report_data: Dict) -> List`
Generate compliance status section.

## Examples

### Example 1: Multi-Format Export

```python
from grc_tool import GRCScanner
from grc_tool.reporting import PDFExporter, ReportGenerator
import json

# Scan
scanner = GRCScanner()
results = scanner.scan("192.168.1.0/24")

# Generate comprehensive report
report_gen = ReportGenerator('./reports')
report_data = report_gen.generate_comprehensive_report(results)

# Export PDF
pdf_exp = PDFExporter('./reports')
pdf_file = pdf_exp.export_to_pdf(report_data)

# Export JSON
with open('./reports/data.json', 'w') as f:
    json.dump(results, f, indent=2)

print(f"Reports generated:")
print(f"  PDF: {pdf_file}")
print(f"  JSON: ./reports/data.json")
```

### Example 2: Custom PDF Filename

```python
from datetime import datetime

# Custom filename with target and date
target = "192.168.1.100"
date = datetime.now().strftime("%Y%m%d")
filename = f"security_audit_{target.replace('.', '_')}_{date}.pdf"

pdf_exporter = PDFExporter('./audits')
pdf_path = pdf_exporter.export_to_pdf(report_data, filename=filename)
```

### Example 3: Scheduled Exports

```python
import schedule
import time

def weekly_report():
    """Generate weekly security report."""
    scanner = GRCScanner()
    results = scanner.scan("network-range")
    
    # Export all formats
    export_all_formats(results, './weekly_reports')
    print("Weekly report generated")

# Schedule every Monday at 9 AM
schedule.every().monday.at("09:00").do(weekly_report)

while True:
    schedule.run_pending()
    time.sleep(3600)
```

## Troubleshooting

### PDF Generation Fails

```bash
# Install reportlab
pip install reportlab

# Check permissions
chmod 755 ./reports

# Verify disk space
df -h
```

### Large File Sizes

```python
# Compress JSON
import gzip
import json

with gzip.open('report.json.gz', 'wt') as f:
    json.dump(scan_results, f)
```

### Slow Export

- Reduce data volume in report
- Use faster storage (SSD)
- Optimize report generation logic

## See Also

- [GUI Usage Guide](GUI_USAGE.md)
- [API Documentation](API.md)
- [Configuration Guide](CONFIGURATION.md)
